// Blood Frontier: Default Configuration

exec "packages/keymap.cfg"
exec "packages/engine.cfg"
exec "packages/brush.cfg"
exec "packages/menus.cfg"
exec "packages/sounds.cfg"

// Game Aliases
// Modes (single integer):
//		0		Demo
//		1		Coop
//		2		Singleplayer
//		3		Deathmatch
//		4		Capture
// Mutators (bitwise and):
//		0x0001	Team
//		0x0002	Instagib
//		0x0004	Duel

mapcomplete			= [ complete $arg1 packages/base bgz ]
start				= [ mode $arg1 $arg2; map $arg3 ]; mapcomplete start

demo				= [ stopdemo; start 0 0x00 $arg1 ]; complete demo . dmo

coopedit			= [ start 1 0x0000 $arg1 ]; mapcomplete coopedit
singleplayer		= [ start 2 0x0000 $arg1 ]; mapcomplete singleplayer

deathmatch			= [ start 3 0x0000 $arg1 ]; mapcomplete deathmatch
teamdm				= [ start 3 0x0001 $arg1 ]; mapcomplete teamdm
instadm				= [ start 3 0x0002 $arg1 ]; mapcomplete instadm
teaminstadm			= [ start 3 0x0003 $arg1 ]; mapcomplete teaminstadm
dueldm				= [ start 3 0x0004 $arg1 ]; mapcomplete dueldm
teamdueldm			= [ start 3 0x0005 $arg1 ]; mapcomplete teamdueldm
instadueldm			= [ start 3 0x0006 $arg1 ]; mapcomplete instadueldm
teaminstadueldm		= [ start 3 0x0007 $arg1 ]; mapcomplete teaminstadueldm

capture				= [ start 4 0x0001 $arg1 ]; mapcomplete capture
instacapture		= [ start 4 0x0003 $arg1 ]; mapcomplete instacapture
duelcapture			= [ start 4 0x0005 $arg1 ]; mapcomplete duelcapture
instaduelcapture	= [ start 4 0x0007 $arg1 ]; mapcomplete instaduelcapture

name "unnamed"
team "none"

bind W forward
bind A left
bind S backward
bind D right

bind UP "forward"
bind DOWN "backward"
bind RIGHT "right"
bind LEFT "left"

bind LSHIFT "crouch"
bind SPACE "jump"
bind MOUSE2 "jump"
bind MOUSE1 "attack"
bind MOUSE3 "reload"

bind R repammo

bind TAB "showscores"

bind T "saycommand"
bind BACKQUOTE "saycommand /"
bind SLASH "saycommand /"

bind I taunt

bind E "edittoggle"

bind KP_MINUS "conskip 1"
bind KP_PLUS "conskip -1000"

bindvar F1 paused

bind F11 "toggleconsole"
bind F12 "screenshot"

bindvar F1 paused
bindvar F10 grabmouse
bind KP_MULTIPLY [ togglemusic ]
bind KP_DIVIDE [ togglesound ]

bind KP_MINUS "conskip 1"
bind KP_PLUS "conskip -1000"
bind F11 "toggleconsole"
bind F12 "screen"

editbind KP1 [ editmat air ]
editbind KP2 [ editmat clip ]
editbind KP3 [ editmat water ]
editbind KP4 [ editmat glass ]

editbind INSERT [ sendmap ]
editbind DELETE [ getmap ]

bind MOUSE4 "universaldelta 1"	// also used for editing, see below
bind MOUSE5 "universaldelta -1"

editbind SPACE  [ cancelsel; passthroughsel 0 ] // meh.. will need to make better fix
editbind MOUSE1 "editdrag"
editbind MOUSE3 "selcorners"
editbind MOUSE2 "editextend"

editbind N        "entselect insel"
editbind M        "selentfindall"

editbind LSHIFT		[ floatspeed 1000; onrelease [ floatspeed 100 ] ]
editbindmod LCTRL	[ hmapctrl ]
editbindmod LALT	[ passthrough ]
editbindmod RALT	[ passthrough ]

do [brush_2] //421

editbind X editflip
editbind C editcopy
editbind V editpaste
editbind U editcut
editbind Z [ undo; passthroughsel 0]
editbind I redo
editbind H [ hmapedit ( ! $hmapedit ) ]
editbind BACKSPACE editdel

editbind G "domodifier 1" // domodifier 1 -> executes delta_edit_1
editbind F "domodifier 2" // etc...
editbind Q "domodifier 3"
editbind R "domodifier 4" 
editbind Y "domodifier 6"
editbind B [ domodifier 9; brushcopy = 0; ]
editbind J [ domodifier 9; brushcopy = 0; ]
editbind COMMA  [ domodifier 10; onrelease entautoview ]

editbindvar 6 entselsnap
editbindvar 7 outline
editbindvar 8 wireframe
bindvar 9 thirdperson
editbindvar 0 allfaces
bindvar L fullbright

editbind PERIOD selentedit

editbind TAB [ cleargui; showentgui ]
editbind F2 showtexgui
editbind F3 calclight
editbind F4 calclight 3
editbind F5 recalc
editbind F6 savemap

editbind P [ showentdir (= $showentdir 0); showentradius (= $showentradius 0) ]

editbind 1 [ domodifier 11 ]
editbind 2 [ domodifier 12 ]
editbind 3 [ domodifier 13 ]
editbind 4 [ domodifier 14 ]

bind E [ if (= (getgamemode) 1) [ edittoggle ] [ coopedit (mapname); sleep 5000 [ edittoggle ] ] ]

bind HOME		[ cameramode ]
bind END		[ if (= $cameracycle 0) [ cameracycle 10; ] [ cameracycle 0; ] ]

loop c 255 [
	(concatword camera_name_ $c) = (concat Camera (concatword "#" (+ $c 1)))
]

bind C			[ domodifier 9 ]
delta_game_9 =	[ cameradir $arg1 ]

cm = 0
alias cameramode [
	if (= $cm 0) [
		spectator 1; cameradir 1; cameracycle 10; cm = 1;
	] [
		spectator 0; cameradir 0; cameracycle 10; cm = 0;
	]
]

bind 1 [ weapon 0 ]
bind 2 [ weapon 1 ]
bind 3 [ weapon 2 ]
bind 4 [ weapon 3 ]
bind 5 [ weapon 4 ]
bind 6 [ weapon 5 ]
bind 7 [ weapon 6 ]

delta_game_0 = [ weapon -1 $arg1 ]

zooming = 0
zoomsize = 10
zoomhair = 500
zoomsens = 4

zoomcrosshairsize = $crosshairsize
zoomsensitivityscale = $sensitivityscale
zoomfov = $fov
zoomhudgun = $hudgun

alias zoomer [
	changed = 0
	chamt = (div (- $zoomhair $zoomcrosshairsize) 10)
	fvmax = 120; if (= $thirdperson 1) [ fvmax = 100 ]
	fvmin = 90; if (= (getgun) 5) [ fvmin = $zoomsize ]
	fvamt = (div (- $zoomfov $fvmin) 10)

	if (= $zooming 1) [
		if (> $zoomhair $crosshairsize) [
			i = (+ $crosshairsize $chamt)
			if (< $i 1000) [ crosshairsize $i ] [ crosshairsize 1000 ]
			if (< $zoomhair $crosshairsize) [ crosshairsize $zoomhair ] [ changed = 1 ]
		]
		if (< $fvmin $fov) [
			i = (- $fov $fvamt)
			if (> $i 10) [ fov $i ] [ fov 10 ]
			if (> $fvmin $fov) [ fov $fvmin ] [ changed = 1 ]
		]
		if (= $changed 1) [ sleep 10 [ zoomer ] ]
	] [
	if (= $zooming 2) [ 
		if (< $zoomcrosshairsize $crosshairsize) [
			i = (- $crosshairsize $chamt)
			if (> $i 0) [ crosshairsize $i ] [ crosshairsize 1 ]
			if (> $zoomcrosshairsize $crosshairsize) [ crosshairsize $zoomcrosshairsize ] [ changed = 1 ]
		]
		if (> $zoomfov $fov) [
			i = (+ $fov $fvamt)
			if (< $i $fvmax) [ fov $i ] [ fov $fvmax ]
			if (< $zoomfov $fov) [ fov $zoomfov ] [ changed = 1 ]
		]
		if (= $changed 1) [
			sleep 10 [ zoomer ]
		] [
			hudgun $zoomhudgun
			sensitivityscale $zoomsensitivityscale
			loadcrosshair "packages/textures/crosshair.png"
			zooming = 0
		]
	] ]
]

alias zoom [
	if (= $zooming 0) [
		zoomcrosshairsize = $crosshairsize
		zoomsensitivityscale = $sensitivityscale
		zoomfov = $fov
		zoomhudgun = $hudgun

		hudgun 0
		sensitivityscale $zoomsens
		zooming = 1
		loadcrosshair "packages/textures/crosshair_zoom.png"
		zoomer
	]
	onrelease [
		if (= $zooming 1) [
			zooming = 2
			zoomer
		]
	]
]

bind MOUSE2 [ zoom ]

bind F9 [
	setmaster 1
	sleep 100 [ mastermode 1 ]
]
