// Blood Frontier: Default Configuration

exec "keymap.cfg"
exec "engine.cfg"
exec "brush.cfg"
exec "sounds.cfg"

// Game Aliases
// Modes (single integer):
//		0		Demo
//		1		Lobby
//		2		Edit
//		3		Singleplayer
//		4		Deathmatch
//		5		Secure-the-Flag
//		6		Capture-the-Flag
// Mutators (bitwise and):
//		0x0001	Multi-Sided
//		0x0002	Team
//		0x0004	Instagib
//		0x0008	Duel
//		0x0010	Last-Man-Standing
//		0x0020	Paintball
//		0x0040	Vampire
//		0x0080	Arena

mapcomplete			= [ complete $arg1 maps bgz ]
mapcomplete map
start				= [ mode $arg2 $arg3; map $arg1 ]; mapcomplete start

demo				= [ stopdemo; start $arg1 0 0x00 ]; complete demo . dmo

lobby				= [ start $arg1 1 0x0000 ]; mapcomplete lobby
edit				= [ start $arg1 2 0x0000 ]; mapcomplete edit
mission				= [ start $arg1 3 0x0000 ]; mapcomplete mission
deathmatch			= [ start $arg1 4 0x0000 ]; mapcomplete deathmatch
instagib			= [ start $arg1 4 0x0004 ]; mapcomplete instagib
teamdm				= [ start $arg1 4 0x0002 ]; mapcomplete teamdm
instateamdm			= [ start $arg1 4 0x0006 ]; mapcomplete instateamdm
multidm				= [ start $arg1 4 0x0003 ]; mapcomplete multidm
instamultidm		= [ start $arg1 4 0x0007 ]; mapcomplete instamultidm
stf					= [ start $arg1 5 0x0002 ]; mapcomplete stf
multistf			= [ start $arg1 5 0x0003 ]; mapcomplete multistf
instastf			= [ start $arg1 5 0x0006 ]; mapcomplete instastf
ctf					= [ start $arg1 6 0x0002 ]; mapcomplete ctf
multictf			= [ start $arg1 6 0x0003 ]; mapcomplete multictf
instactf			= [ start $arg1 6 0x0006 ]; mapcomplete instactf
duel				= [ start $arg1 4 0x0008 ]; mapcomplete duel
instaduel			= [ start $arg1 4 0x000C ]; mapcomplete instaduel
lms					= [ start $arg1 4 0x0010 ]; mapcomplete lms
instalms			= [ start $arg1 4 0x0014 ]; mapcomplete instalms
paintball			= [ start $arg1 4 0x0020 ]; mapcomplete paintball
instapaint			= [ start $arg1 4 0x0024 ]; mapcomplete instapaint

toggleedit			= [ if (= (gamemode) 2) [ edittoggle ] [ edit (mapname) ] ] 

delta_game_0 		= [ if (iszooming) [ setzoom $arg1 ] [ weapon -1 $arg1 ] ]; setcomplete delta_game_0 off

delta_edit_0		= [
	if $blendpaintmode [
		nextblendbrush $arg1
		echo (concatword "^fgblend brush:^fw " (getblendbrushname (curblendbrush)))
	] [
		editfacewentpush $arg1 1
	]
]; setcomplete delta_edit_0 off // Fill and Empty cube //select brushes during blendpaintmode

delta_edit_1		= [ gridpower (+ $arg1 $gridpower) ]; setcomplete delta_edit_1 off
delta_edit_2		= [ editfacewentpush $arg1 0 ]; setcomplete delta_edit_2 off // push face/corners selected
delta_edit_3		= [ editfacewentpush $arg1 2 ]; setcomplete delta_edit_3 off // push corner pointed at by cursor
delta_edit_4		= [ editrotate $arg1 ]; setcomplete delta_edit_4 off // rotate 90 degrees
delta_edit_5		= [ entproperty 0 $arg1 ]; setcomplete delta_edit_5 off  // and the others
delta_edit_6		= [ edittex $arg1 ]; setcomplete delta_edit_6 off // change textures
delta_edit_9		= [ selectbrush $arg1 ]; setcomplete delta_edit_9 off // change heightmap brushes
delta_edit_10		= [ entautoview $arg1 ]; setcomplete delta_edit_10 off
delta_edit_11		= [ entproperty 0 $arg1 ]; setcomplete delta_edit_11 off
delta_edit_12		= [ entproperty 1 $arg1 ]; setcomplete delta_edit_12 off
delta_edit_13		= [ entproperty 2 $arg1 ]; setcomplete delta_edit_13 off
delta_edit_14		= [ entproperty 3 $arg1 ]; setcomplete delta_edit_14 off
delta_edit_15		= [ entproperty 4 $arg1 ]; setcomplete delta_edit_15 off

bind W				[ forward ]
bind A				[ left ]
bind S				[ backward ]
bind D				[ right ]

bind UP				[ forward ]
bind DOWN			[ backward ]
bind RIGHT			[ right ]
bind LEFT			[ left ]

bind LSHIFT			[ crouch ]
bind SPACE			[ jump ]

bind MOUSE1			[ attack ]
bind MOUSE2 		[ zoom ]
bind MOUSE3			[ reload ]

bind I				[ taunt ]
bind E				[ action ]
bind R				[ reload ]
bind F				[ action ]
bind Z				[ drop ]
bind X				[ dropflag ]
bind C				[ crouch ]
bind V				[ zoom ]
bind G				[ weapon 6 ]
bind Q				[ weapon 6 ]
bind K				[ kill ]

bind TAB			[ showscores ]

saytextcommand = 	[inputcommand "" [say $commandbuffer] "textures/conopen")]
sayteamcommand = 	[inputcommand "" [sayteam $commandbuffer] (concatword "textures/" (getteamicon))]

bind T				saytextcommand
bind BACKQUOTE		"saycommand /"
bind SLASH			"saycommand /"
bind Y 				[ if (& (mutators) 0x0002) [ sayteamcommand ] [ saytextcommand ] ]

bind KP_MINUS		[ mastervol (max (- $mastervol 5) 0) ]
bind KP_PLUS		[ mastervol (min (+ $mastervol 5) 255) ]
bind KP_DIVIDE		[ togglesound ]

bind PAGEDOWN		[ conskip 1 ]
bind PAGEUP			[ conskip -1000 ]

bind INSERT			[ addbot ]
bind DELETE			[ delbot ]
bind HOME			[ spectator 1 ]
bind END			[ spectator 0 ]

bind F1				[ toggleedit ]
bind F2				[ showgui game ]
bind F5				[ setmaster 1 ]
bindvar F10			[ inputgrab ]
bind F11			[ toggleconsole ]
bind F12			[ screenshot "screenshot" ]

bind COMMA  		[ showgui arena ]

editbind F2			[ showtexgui ]
editbind F3			[ cleargui; showentgui ]
editbind F4			[ calclight 3 ]
editbind F5			[ recalc ]
editbind F6			[ savemap ]
editbind F7			[ showgui findent ]

bind 1				[ weapon 0 ]
bind 2				[ weapon 1 ]
bind 3				[ weapon 2 ]
bind 4				[ weapon 3 ]
bind 5				[ weapon 4 ]
bind 6				[ weapon 5 ]
bind 7				[ weapon 6 ]
bind 8				[ weapon 7 ]
bindvar 9			thirdperson

editbind 1 			[ domodifier 11 ]
editbind 2 			[ domodifier 12 ]
editbind 3 			[ domodifier 13 ]
editbind 4 			[ domodifier 14 ]
editbind 5 			[ domodifier 15 ]
editbindvar 6		entselsnap
editbind 7			[ changeoutline 1 ]
editbindvar 8		wireframe
editbindvar 9		bypassheightmapcheck
editbindvar 0		allfaces
editbindvar K		blankgeom
editbind C			[ domodifier 9 ]

editbind INSERT 	[ sendmap ]
editbind DELETE		[ getmap ]

editbind LSHIFT		[ floatspeed 300; modscale = 10; onrelease [ floatspeed 75; modscale = 1; ] ]
editbindmod LCTRL	passthrough
editbind LALT		[ hmapedit; blendpaintmode 0 ]
gridbindstyle = 2
gridbindswitch = 0
editbind TAB [
	if (= $gridbindstyle 2) [
		if (= $gridbindswitch 3) [ showpastegrid 0; showcursorgrid 0; showselgrid 0; gridbindswitch = 0 ] [
			if (= $gridbindswitch 2) [ showpastegrid 0; showcursorgrid 0; showselgrid 1; gridbindswitch = 3 ] [
				if (= $gridbindswitch 1) [ showpastegrid 0; showcursorgrid 1; showselgrid 0; gridbindswitch = 2 ] [
					if (= $gridbindswitch 0) [ showpastegrid 1; showcursorgrid 0; showselgrid 0; gridbindswitch = 1 ]
				]
			]
		]
	]
	if (= $gridbindstyle 1) [
		if (= $gridbindswitch 1) [
			showpastegrid 0; showcursorgrid 0; showselgrid 0; gridbindswitch = 0
		] [
			showpastegrid 1; showcursorgrid 1; showselgrid 1; gridbindswitch = 1
		]
	]
	if (= $gridbindstyle 0) [
		showpastegrid 1; showcursorgrid 1; showselgrid 1; onrelease [ showpastegrid 0; showcursorgrid 0; showselgrid 0 ]
	]
]

bind MOUSE4			[ universaldelta 1 ]	// also used for editing, see below
bind MOUSE5			[ universaldelta -1 ]
bind LEFTBRACKET	[ universaldelta 1 ]
bind RIGHTBRACKET	[ universaldelta -1 ]

editbind SPACE  	[ cancelsel ]
editbind MOUSE1		[ if $blendpaintmode paintblendmap editdrag ]
editbind MOUSE3		[ selcorners ]
editbind MOUSE2		[ if $blendpaintmode rotateblendbrush editextend]

editbind N       	[ entselect insel ]
editbind M       	[ selentfindall ]
do [brush_2] //421

editbind L			[ entlink ]
editbind X			[ editflip ]
editbind C			[ editcopy ]
editbind V			[ editpaste ]
editbind U			[ editcut ]
editbind Z			[ undo; passthroughsel 0 ]
editbind I			[ redo ]
editbind H			[ if $hmapedit [ editface 1 -1 ] [ hmapedit 1 ]; blendpaintmode 0 ]
editbind BACKSPACE	[ editdel ]

editbind G			[ domodifier 1 ] // domodifier 1 -> executes delta_edit_1
editbind F			[ domodifier 2 ] // etc...
editbind Q			[ domodifier 3 ]
editbind R			[ domodifier 4 ] 
editbind Y			[ domodifier 6 ]
editbind J 			[ domodifier 9; brushcopy = 0; ]
editbind COMMA  	[ domodifier 10; onrelease entautoview ]

editbind PERIOD		selentedit

//editbindvar P 		dropwaypoints //ye olde P bind

paintmodes = ["off" "overwrite blendmap" "merge blendmap" "max opacity to brush's" "inverted merge" "opacity multiplier (erasing)"]

editbind P [
	hmapedit 0;
	blendpaintmode (if (= $blendpaintmode 5) 0 (+ $blendpaintmode 1));
	echo (concatword "^fgblend mode:^fw " (at $paintmodes $blendpaintmode))
]
editbindvar B		fullbright

editbind KP1 		[ editmat air ]
editbind KP2 		[ editmat clip ]
editbind KP3		[ editmat water ]
editbind KP4 		[ editmat glass ]

enttypelist = [ 
light
mapmodel
playerstart
envmap
particles
sound
spotlight
weapon
teleport
monster
trigger
pusher
base
checkpoint
camera
waypoint
announcer
trigger
connection
]

entcomplete = [ listcomplete $arg1 $enttypelist ]

// entcomplete gets defined by game
entcomplete newent
entcomplete entfind

enttypelength = (listlen $enttypelist)
enttypeselect = [     
  n = $enttypelength
  next = (+ (listindex $enttypelist (et)) $arg1)
  if (< $next 0)  [ next = (- $n 1) ]
  if (= $next $n) [ next = 0 ]
  next = (at $enttypelist $next)
  entset $next (ea 0) (ea 1) (ea 2) (ea 3) 
]

////// Entity primary actions /////////

ent_action_base           = [ entproperty 0 ( * $arg1 1 ) ]
ent_action_teleport       = [ entproperty 0 ( * $arg1 1 ) ]
ent_action_monster        = [ entproperty 1 ( * $arg1 1 ) ]
ent_action_mapmodel       = [ entproperty 0 ( * $arg1 1 ) ]
ent_action_spotlight      = [ entproperty 0 ( * $arg1 5 ) ]
ent_action_light          = [ entproperty 0 ( * $arg1 5 ) ]
ent_action_pusher         = [ entproperty 0 ( * $arg1 5 ) ]
ent_action_checkpoint     = [ entproperty 0 ( * $arg1 15 ) ]
ent_action_playerstart    = [ entproperty 0 ( * $arg1 15 ) ]
ent_action_envmap         = [ entproperty 0 ( * $arg1 5 ) ]
ent_action_particles      = [ entproperty 0 ( * $arg1 1 ) ]
ent_action_sound          = [ entproperty 0 ( * $arg1 1 ) ]
ent_action_cycle          = [ entset ( if ( > $arg1 -1 ) [ result $arg2 ] [ result $arg3 ] ) ]

exec "menus.cfg" // keep this here, it uses some of the stuff above

specbind LSHIFT		[ floatspeed 500; onrelease [ floatspeed 75 ] ]
specbind MOUSE1		[ specmodeswitch ]
specbind MOUSE2		[ spectator 0 ]
//specbind MOUSE4	[ specfollow 1 ]
//specbind MOUSE5	[ specfollow -1 ]

waitbind LSHIFT		[ floatspeed 500; onrelease [ floatspeed 75 ] ]

musicfiles = [
	"loops/mitaman/blinkrage"
	"loops/mitaman/dirtyboyz"
	"loops/mitaman/enterdeath"
	"loops/mitaman/heavyhit"
	"loops/mitaman/mrebow"
	"loops/mitaman/oppforce"
	"loops/mitaman/summerend"
	"loops/mitaman/bloodystreet"
]
playmusic = [ music (at $musicfiles (rnd (listlen $musicfiles))) ]

// some aliases
fov = [ if (= (inthirdperson) 1) [ thirdpersonfov $arg1 ] [ firstpersonfov $arg1 ] ] // people have complained /fov was removed

// sauer rotation aliases
alias octamaps [
	mainmaps "complex douze ot academy metl2 metl3 nmp8 refuge tartech kalking1 dock turbine fanatic_quake oddworld wake5 aard3c curvedm fragplaza pgdm kffa neondevastation hog2 memento neonpanic lostinspace DM_BS1 shindou sdm1 shinmei1 stemple powerplant phosgene oasis island metl4 ruby frozen ksauer1 killfactory corruption deathtek aqueducts orbe roughinery shadowed torment moonlite darkdeath orion nmp10 katrez_d thor frostbyte ogrosupply kmap5 thetowers guacamole tejen hades paradigm mechanic wdcd"
	ctfmaps "hallo reissen flagstone face-capture shipwreck dust2 urban_c berlin_wall akroseum valhalla damnation mach2 redemption tejen europium capture_night l_ctf forge campo wdcd sacrifice core_transfer recovery"
	stfmaps "urban_c nevil_c fb_capture nmp9 c_valley lostinspace fc3 face-capture nmp4 nmp8 hallo monastery ph-capture hades fc4 relic frostbyte venice paradigm corruption asteroids ogrosupply reissen akroseum duomo capture_night c_egypt tejen dust2 campo killcore3 damnation arabic cwcastle river_c serenity"
]
