// Blood Frontier: Default Configuration

exec "keymap.cfg"
exec "engine.cfg"
exec "brush.cfg"
exec "sounds.cfg"

// Game Aliases
// Modes (single integer):
//		0		Demo
//		1		Lobby
//		2		Edit
//		3		Story
//		4		Deathmatch
//		5		Secure-the-Flag
//		6		Capture-the-Flag
//		7		Time Trial
// Mutators (bitwise and):
//		0x0001	Multi-Sided
//		0x0002	Team
//		0x0004	Instagib
//		0x0008	Duel
//		0x0010	Survivor
//		0x0020	Arena

mapcomplete			= [ complete $arg1 maps bgz ]
mapcomplete map
start				= [ mode $arg2 $arg3; map $arg1 ]; mapcomplete start

demo				= [ stopdemo; start $arg1 0 0x00 ]; complete demo . dmo

lobby				= [ start $arg1 1 0x0000 ]; mapcomplete lobby
edit				= [ start $arg1 2 0x0000 ]; mapcomplete edit
story				= [ start $arg1 3 0x0000 ]; mapcomplete story
deathmatch			= [ start $arg1 4 0x0000 ]; mapcomplete deathmatch; dm = [ deathmatch $arg1 ]
instagib			= [ start $arg1 4 0x0004 ]; mapcomplete instagib; insta = [ instagib $arg1 ]
arena				= [ start $arg1 4 0x0020 ]; mapcomplete arena
teamdm				= [ start $arg1 4 0x0002 ]; mapcomplete teamdm
teamarena			= [ start $arg1 4 0x0022 ]; mapcomplete teamarena
instateamdm			= [ start $arg1 4 0x0006 ]; mapcomplete instateamdm
multidm				= [ start $arg1 4 0x0003 ]; mapcomplete multidm
multiarena			= [ start $arg1 4 0x0023 ]; mapcomplete multiarena
instamultidm		= [ start $arg1 4 0x0007 ]; mapcomplete instamultidm
stf					= [ start $arg1 5 0x0002 ]; mapcomplete stf
stfarena			= [ start $arg1 5 0x0022 ]; mapcomplete stfarena
multistf			= [ start $arg1 5 0x0003 ]; mapcomplete multistf
multistfarena		= [ start $arg1 5 0x0023 ]; mapcomplete multistfarena
instastf			= [ start $arg1 5 0x0006 ]; mapcomplete instastf
ctf					= [ start $arg1 6 0x0002 ]; mapcomplete ctf
ctfarena			= [ start $arg1 6 0x0022 ]; mapcomplete ctfarena
multictf			= [ start $arg1 6 0x0003 ]; mapcomplete multictf; mctf = [ multictf $arg1 ]
multictfarena		= [ start $arg1 6 0x0023 ]; mapcomplete multictfarena; mctfarena = [ multictfarena $arg1 ]
instactf			= [ start $arg1 6 0x0006 ]; mapcomplete instactf
duel				= [ start $arg1 4 0x0008 ]; mapcomplete duel
duelarena			= [ start $arg1 4 0x0028 ]; mapcomplete duelarena
instaduel			= [ start $arg1 4 0x000C ]; mapcomplete instaduel
survivor			= [ start $arg1 4 0x0010 ]; mapcomplete survivor; lms = [ survivor $arg1 ]
survivorarena		= [ start $arg1 4 0x0030 ]; mapcomplete survivorarena
instasurvivor		= [ start $arg1 4 0x0014 ]; mapcomplete instasurvivor
timetrial			= [ start $arg1 7 0x0000 ]; mapcomplete timetrial; trial = [ timetrial $arg1 ]
trialarena			= [ start $arg1 7 0x0020 ]; mapcomplete trialarena
instatrial			= [ start $arg1 7 0x0004 ]; mapcomplete instatrial

toggleedit			= [ if (= (gamemode) 2) [ edittoggle ] [ edit $mapname ] ] 

delta_game_0 		= [ if (iszooming) [ setzoom $arg1 ] [ weapon -1 $arg1 ] ]; setcomplete delta_game_0 off

delta_edit_0		= [
	if $blendpaintmode [
		nextblendbrush $arg1
		echo (concatword "^fgblend brush:^fw " (getblendbrushname (curblendbrush)))
	] [
		editfacewentpush $arg1 1
	]
]; setcomplete delta_edit_0 off // Fill and Empty cube //select brushes during blendpaintmode

delta_edit_1		= [ gridpower (+ $arg1 $gridpower) ]; setcomplete delta_edit_1 off
delta_edit_2		= [ editfacewentpush $arg1 0 ]; setcomplete delta_edit_2 off // push face/corners selected
delta_edit_3		= [ editfacewentpush $arg1 2 ]; setcomplete delta_edit_3 off // push corner pointed at by cursor
delta_edit_4		= [ editrotate $arg1 ]; setcomplete delta_edit_4 off // rotate 90 degrees
delta_edit_5		= [ entproperty 1 $arg1 ]; setcomplete delta_edit_5 off  // and the others
delta_edit_6		= [ edittex $arg1 ]; setcomplete delta_edit_6 off // change textures
delta_edit_9		= [ selectbrush $arg1 ]; setcomplete delta_edit_9 off // change heightmap brushes
delta_edit_10		= [ entautoview $arg1 ]; setcomplete delta_edit_10 off
delta_edit_11		= [ entproperty 1 $arg1 ]; setcomplete delta_edit_11 off
delta_edit_12		= [ entproperty 2 $arg1 ]; setcomplete delta_edit_12 off
delta_edit_13		= [ entproperty 3 $arg1 ]; setcomplete delta_edit_13 off
delta_edit_14		= [ entproperty 4 $arg1 ]; setcomplete delta_edit_14 off
delta_edit_15		= [ entproperty 5 $arg1 ]; setcomplete delta_edit_15 off
delta_edit_16		= [ entproperty 6 $arg1 ]; setcomplete delta_edit_16 off
delta_edit_17		= [ entproperty 7 $arg1 ]; setcomplete delta_edit_17 off
delta_edit_18		= [ entproperty 8 $arg1 ]; setcomplete delta_edit_18 off
delta_edit_19		= [ entproperty 9 $arg1 ]; setcomplete delta_edit_19 off

// actions: attack = 0, alternate = 1, reload = 2, use = 3, jump = 4, impulse = 5, crouch = 6, special = 7

bind W				[ forward ]
bind A				[ left ]
bind S				[ backward ]
bind D				[ right ]

bind UP				[ forward ]
bind DOWN			[ backward ]
bind RIGHT			[ right ]
bind LEFT			[ left ]

bind LSHIFT			[ action 5 ] // sprint
bind LCTRL			[ action 6 ] // crouch
bind SPACE			[ action 4 ] // jump

bind MOUSE1			[ action 0 ] // attack
bind MOUSE2 		[ action 1 ] // alt-attack
bind MOUSE3			[ action 2 ] // reload

bind E				[ action 3 ] // action
bind R				[ action 2 ] // reload
bind F				[ action 7 ] // impulse
bind Z				[ drop ]
bind X				[ action 5 ] // sprint
bind C				[ action 6 ] // crouch
bind V				[ action 1 ] // alt-attack
bind G				[ weapon 7 ] // grenades
bind Q				[ action 7 ] // impulse
bind K				[ kill ]

bind TAB			[ showscores ]

saytextcommand = 	[inputcommand "" [say $commandbuffer] "textures/conopen"]
sayteamcommand = 	[inputcommand "" [sayteam $commandbuffer] (concatword "textures/" (getteamicon))]

bind T				[ saytextcommand ]
bind BACKQUOTE		"saycommand /"
bind SLASH			"saycommand /"
bind Y 				[ sayteamcommand ]

bind KP_MINUS		[ mastervol (max (- $mastervol 5) 0) ]
bind KP_PLUS		[ mastervol (min (+ $mastervol 5) 255) ]
bind KP_DIVIDE		[ togglesound ]

bind PAUSE			[ if (= $gamepaused 1) [ gamepaused 0 ] [ gamepaused 1 ] ]
bind PAGEDOWN		[ conskip (- 0 $consize) ]
bind PAGEUP			[ conskip $consize ]

bind INSERT			[ addbot ]
bind DELETE			[ delbot ]
bind HOME			[ spectator 1 ]
bind END			[ spectator 0 ]

bind F1				[ toggleedit ]
bind F2				[ showgui game ]
bind F3				[ showgui vote ]
bind F5				[ setmaster 1 ]
bindvar F10			grabinput
bind F11			[ toggleconsole ]
bind F12			[ screenshot "screenshot" ]

bind COMMA  		[ showgui arena ]

editbind F2			[ showtexgui ]
editbind F4			[ calclight 3 ]
editbind F5			[ recalc ]
editbind F6			[ savemap ]
editbind F7			[ showgui findent ]
editbindvar F8		entselsnap
editbind F9			[ changeoutline 1 ]

bind 1				[ weapon 0 ] // melee
bind 2				[ weapon 1 ] // pistol
bind 3				[ weapon 2 ] // shotgun
bind 4				[ weapon 3 ] // smg
bind 5				[ weapon 4 ] // flamer
bind 6				[ weapon 5 ] // plasma
bind 7				[ weapon 6 ] // rifle
bind 8				[ weapon 7 ] // grenade
bind 9				[ weapon 8 ] // insta
bindvar 0			thirdperson

editbind 1 			[ domodifier 11 ]
editbind 2 			[ domodifier 12 ]
editbind 3 			[ domodifier 13 ]
editbind 4 			[ domodifier 14 ]
editbind 5 			[ domodifier 15 ]
editbind 6 			[ domodifier 16 ]
editbind 7 			[ domodifier 17 ]
editbind 8 			[ domodifier 18 ]
editbind 9 			[ domodifier 19 ]
editbindvar 0		allfaces
editbindvar K		blankgeom
editbind C			[ domodifier 9 ]

editbind INSERT 	[ sendmap ]
editbind DELETE		[ getmap ]

editfloatspeed = 350
editmodscale = 10
floatspeed_bak = 75
editshift = [
	if (= $arg1 1) [
		floatspeed_bak = $floatspeed
		floatspeed $editfloatspeed
		modscale = $editmodscale
	] [
		floatspeed $floatspeed_bak
		modscale = 1
	]
]
editbind LSHIFT		[ editshift 1; onrelease [ editshift 0 ] ]

passthroughsel_bak = 0
passthroughcube_bak = 0
passthrough = [
	if (= $arg1 1) [
		passthroughsel_bak = $passthroughsel
		passthroughcube_bak = $passthroughcube
		passthroughsel 1; passthroughcube 1
	] [
		passthroughsel $passthroughsel_bak
		passthroughcube $passthroughcube_bak
	]
	entcancel
]
editbind LCTRL		[ passthrough 1; onrelease [ passthrough 0 ] ]
editbind LALT		[ hmapedit; blendpaintmode 0 ]

gridbindswitch = 0
togglegridbind = [
	if (= $gridbindswitch 3) [ showpastegrid 0; showcursorgrid 0; showselgrid 0; gridbindswitch = 0 ] [
		if (= $gridbindswitch 2) [ showpastegrid 0; showcursorgrid 0; showselgrid 1; gridbindswitch = 3 ] [
			if (= $gridbindswitch 1) [ showpastegrid 0; showcursorgrid 1; showselgrid 0; gridbindswitch = 2 ] [
				if (= $gridbindswitch 0) [ showpastegrid 1; showcursorgrid 0; showselgrid 0; gridbindswitch = 1 ]
			]
		]
	]
]
editbind TAB 		[ togglegridbind ]

bind MOUSE4			[ universaldelta 1 ]	// also used for editing, see below
bind MOUSE5			[ universaldelta -1 ]
bind LEFTBRACKET	[ universaldelta 1 ]
bind RIGHTBRACKET	[ universaldelta -1 ]

editbind SPACE  	[ cancelsel ]
editbind MOUSE1		[ if $blendpaintmode paintblendmap editdrag ]
editbind MOUSE3		[ selcorners ]
editbind MOUSE2		[ if $blendpaintmode rotateblendbrush editextend ]

editbind N       	[ entselect insel ]
editbind M       	[ selentfindall ]
do [brush_2] //421

editbind L			[ entlink ]
editbind X			[ editflip ]
editbind C			[ editcopy ]
editbind V			[ editpaste ]
editbind U			[ editcut ]
editbind Z			[ undo; passthroughsel 0 ]
editbind I			[ redo ]
editbind H			[ if $hmapedit [ editface 1 -1 ] [ hmapedit 1 ]; blendpaintmode 0 ]
editbind BACKSPACE	[ editdel ]

editbind G			[ domodifier 1 ] // domodifier 1 -> executes delta_edit_1
editbind F			[ domodifier 2 ] // etc...
editbind Q			[ domodifier 3 ]
editbind R			[ domodifier 4 ] 
editbind Y			[ domodifier 6 ]
editbind J 			[ domodifier 9; brushcopy = 0; ]
editbind COMMA  	[ domodifier 10; onrelease entautoview ]

editbind PERIOD		selentedit

paintmodes = ["off" "overwrite blendmap" "merge blendmap" "max opacity to brush's" "inverted merge" "opacity multiplier (erasing)"]

editbind P [
	hmapedit 0;
	blendpaintmode (if (= $blendpaintmode 5) 0 (+ $blendpaintmode 1));
	echo (concatword "^fgblend mode:^fw " (at $paintmodes $blendpaintmode))
]
editbindvar B		fullbright

editbind KP1 		[ editmat air ]
editbind KP2 		[ editmat water ]
editbind KP3		[ editmat clip ]
editbind KP4 		[ editmat glass ]
editbind KP5 		[ editmat noclip ]
editbind KP6 		[ editmat lava ]
editbind KP7 		[ editmat death ]
editbind KP8 		[ editmat aiclip ]
editbind KP9 		[ editmat ladder ]

enttypelist = [ 
	light
	mapmodel
	playerstart
	envmap
	particles
	sound
	lightfx
	sunlight
	weapon
	teleport
	actor
	trigger
	pusher
	flag
	checkpoint
	camera
	waypoint
]

entcomplete = [ listcomplete $arg1 $enttypelist ]

// entcomplete gets defined by game
entcomplete newent
entcomplete entfind

enttypelength = (listlen $enttypelist)
enttypeselect = [     
  n = $enttypelength
  next = (+ (listindex $enttypelist (et)) $arg1)
  if (< $next 0)  [ next = (- $n 1) ]
  if (= $next $n) [ next = 0 ]
  next = (at $enttypelist $next)
  entset $next (ea 1) (ea 2) (ea 3) (ea 4) (ea 5) (ea 6)
]

exec "menus.cfg" // keep this here, it uses some of the stuff above

specbind LSHIFT		[ floatspeed 250; onrelease [ floatspeed 75 ] ]
specbind MOUSE1		[ specmodeswitch ]
specbind MOUSE2		[ spectator 0 ]
waitbind LSHIFT		[ floatspeed 250; onrelease [ floatspeed 75 ] ]
waitbind MOUSE1		[ waitmodeswitch ]

musicfiles = [
	"loops/mitaman/blinkrage"
	"loops/mitaman/dirtyboyz"
	"loops/mitaman/enterdeath"
	"loops/mitaman/heavyhit"
	"loops/mitaman/mrebow"
	"loops/mitaman/oppforce"
	"loops/mitaman/summerend"
	"loops/mitaman/bloodystreet"
]
playmusic = [ music (at $musicfiles (rnd (listlen $musicfiles))) ]

// some aliases
fov = [ if (= (isthirdperson) 1) [ thirdpersonfov $arg1 ] [ firstpersonfov $arg1 ] ] // people have complained /fov was removed
coop = [ edit $arg1 ]

// sauer rotation aliases
alias octamaps [
	mainmaps "complex douze ot academy metl2 metl3 nmp8 refuge tartech kalking1 dock turbine fanatic_quake oddworld wake5 aard3c curvedm fragplaza pgdm kffa neondevastation hog2 memento neonpanic lostinspace DM_BS1 shindou sdm1 shinmei1 stemple powerplant phosgene oasis island metl4 ruby frozen ksauer1 killfactory corruption deathtek aqueducts orbe roughinery shadowed torment moonlite darkdeath orion nmp10 katrez_d thor frostbyte ogrosupply kmap5 thetowers guacamole tejen hades paradigm mechanic wdcd"
	ctfmaps "hallo reissen flagstone face-capture shipwreck dust2 urban_c berlin_wall akroseum valhalla damnation mach2 redemption tejen europium capture_night l_ctf forge campo wdcd sacrifice core_transfer recovery"
	stfmaps "urban_c nevil_c fb_capture nmp9 c_valley lostinspace fc3 face-capture nmp4 nmp8 hallo monastery ph-capture hades fc4 relic frostbyte venice paradigm corruption asteroids ogrosupply reissen akroseum duomo capture_night c_egypt tejen dust2 campo killcore3 damnation arabic cwcastle river_c serenity"
]
